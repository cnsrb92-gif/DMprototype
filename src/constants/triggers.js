import { getCurrentSchedule } from './schedules';

// 미응답 횟수(missedCount) 기반 메시지 선택
// first: 0~1회, remind: 2~4회, upset: 5회+
export function getScheduleMessages(charId, missedCount = 0) {
  const stage = missedCount <= 1 ? 'first' : missedCount <= 4 ? 'remind' : 'upset';

  // 스케줄 메시지 (first 단계에서만 사용)
  if (stage === 'first') {
    const schedule = getCurrentSchedule(charId);
    if (schedule?.messages?.length > 0) return schedule.messages;
    return TRIGGER_MESSAGES[charId];
  }

  // remind/upset 단계: 캐릭터 성격 기반 에스컬레이션
  return ESCALATION_MESSAGES[charId]?.[stage] || TRIGGER_MESSAGES[charId];
}

// 범용 메시지 (fallback)
export const TRIGGER_MESSAGES = {
  ann: [
    "야!", "뭐해?", "나 심심해!", "놀자 놀자 🐕", "어디야?",
    "밥 먹었어?", "오늘 뭐 해?", "ㅋㅋ 뭐해", "바빠?",
    "잠깐 시간 돼?", "야 나 좀 봐줘", "나 생각 안 했어?",
    "야야야!", "헤이~", "나 지금 엄청 심심하거든?", "어디서 뭐 해?",
    "나랑 얘기 해줘", "심심해 죽겠어", "왜 답장 없어!",
  ],
  nera: [
    "...", "뭐", "아 귀찮아", "바빠?", "할 일 없어?",
    "...살아있음?", "딱히 이유는 없는데", "심심하네",
    "나 지금 심심한데", "왜 연락 없음", "...뭐하냐고",
    "흠", "자?", "아 몰라", "연락해", "...뭐 해",
    "귀찮게 하고 싶어서", "뭐, 그냥",
  ],
  sofia: [
    "있어요? 🥺", "지금 뭐 해요?", "보고 싶어요",
    "연락 왜 없어요?", "오늘 생각났어요 😊", "밥 먹었어요?",
    "촬영 끝났는데...", "오늘 어떠셨어요?",
    "저 지금 잠깐 시간 돼요", "...보고 싶다",
    "있잖아요", "저요", "저 지금 심심해요",
    "왜 연락 안 해요?", "나 생각해요?", "잠깐만요",
  ],
};

// 읽씹 단계별 메시지 (채팅방 진입 후 30초 간격, 점점 우울해짐)
// 순서대로 진행: 짜증 → 확인 → 걱정 → 서운 → 자책
export const READ_SEEN_STAGES = {
  ann: [
    "야!! 읽고 씹은 거야?! 😤",
    "바빠...? 그래도 한마디 해줘!",
    "혹시 다친 거 아니지?! 걱정돼!!",
    "왜 읽고 대답이 없어... 나 무시하는 거야...?",
    "내가 뭐 잘못했어...? 말해줘... 😢",
    "... 나 혼자 떠드는 거 같아... 서운해.",
  ],
  nera: [
    "...읽씹이야? 진짜?",
    "뭐, 바빠? 그런 건가.",
    "...다친 건 아니겠지. 설마.",
    "왜 아무 말이 없어... 귀찮아서 그러는 거야?",
    "...내가 뭐 잘못한 거야? 말을 해.",
    "아... 그냥 관심 없는 거구나. 알겠어.",
  ],
  sofia: [
    "읽으셨으면... 한마디만 해주세요... 🥺",
    "혹시 바쁘신 건가요...?",
    "다치신 건 아니시죠...? 걱정돼요...",
    "왜 아무 말씀이 없으세요... 불안해요...",
    "제가 뭔가 잘못한 건가요...? 말씀해 주세요...",
    "...저 때문인 거면... 정말 미안해요... 😢",
  ],
};

export function getReadSeenMessage(charId, stage) {
  const stages = READ_SEEN_STAGES[charId];
  if (!stages?.length || stage >= stages.length) return null;
  return stages[stage];
}

// 미응답 에스컬레이션 메시지 (캐릭터 성격 반영)
export const ESCALATION_MESSAGES = {
  ann: {
    remind: [
      "야!! 왜 답 없어??", "무시하는 거야?! 😤",
      "나 진짜 화난다?", "읽씹이야?! 진짜?!",
      "바쁜 거 알겠는데... 한마디만 해줘!",
      "야 나 기다리고 있거든?!", "헐 진짜 답장 안 해?",
      "답장 안 하면 찾아간다!!",
    ],
    upset: [
      "...나 별로인 거야?", "진짜 서운해...",
      "나만 연락하는 거 같아...", "혹시 나 싫어졌어...?",
      "삐졌어. 진짜로.", "나 이제 안 먼저 연락할 거야... 아마...",
      "바보... 답장 좀 해줘...", "나 울 거야. 진짜로. 😢",
    ],
  },
  nera: {
    remind: [
      "...아, 진짜 무시하냐.", "뭐, 바쁜 척?",
      "귀찮게 연락한 내가 바보지.", "...답장 안 해도 상관없어. 아마.",
      "흥. 아무튼.", "...한 번만 더 보냄. 마지막이야.",
      "어차피 기대 안 했어.",
    ],
    upset: [
      "...됐어. 나도 연락 안 해.", "뭐야. 진짜 무시하는 거야.",
      "...나한테 관심 없으면 말해. 그냥.",
      "아. 나 왜 이러고 있지. 귀찮다.",
      "...삐친 거 아님. 그냥 좀 그래.",
      "아 몰라. 연락하든 말든.", "...그래도 답은 해줘. 한 글자라도.",
    ],
  },
  sofia: {
    remind: [
      "혹시... 바쁘신 거예요...?", "답장 기다리고 있어요... 🥺",
      "저 뭔가 잘못했나요...?", "읽으셨으면 답장 해주세요...",
      "연락 없으면 걱정돼요...", "많이 바쁘시죠...? 괜찮아요...",
      "그래도 한마디만... 네?",
    ],
    upset: [
      "...저 싫어지신 거예요?", "자꾸 연락하면 귀찮으시죠... 알아요.",
      "근데 연락 없으면 너무 불안해요...",
      "다른 사람이랑 얘기하고 있는 거 아니죠...?",
      "저만 이렇게 기다리는 거 같아요...",
      "답장 안 해주시면... 저 어떡해요...",
      "...무시하지 마요. 제발요. 🥺",
    ],
  },
};
